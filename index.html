<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¹Ù‡Ø¯ Ø´Ù†Ù‚ÙŠØ·</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{font-family:Arial;background:#f4f6f7;margin:10px}
h2{text-align:center;color:#1e8449}
button{padding:10px;margin:5px;border:none;background:#1e8449;color:#fff;cursor:pointer}
input,textarea{width:100%;padding:8px;margin:4px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
img.photo{width:45px;height:45px;border-radius:50%}
.hidden{display:none}
.card{background:#fff;padding:10px;margin-top:10px;border-radius:6px}
.top{text-align:center}
.logo{width:80px}
.red{background:#c0392b}
.gray{background:#555}
</style>
</head>

<body>

<div class="top">
<img class="logo" src="data:image/jpeg;base64,TVbwLpW5NDnQqJEpSlABO8Xk9Y3+NsCXk2IYghbtWjk2panPO+0dEdkUNK0ohRkR...9LYmMDgFT5ZXMUt2f4VgNTkuWcfl4rebZsMLNlypKE/EQFakvSjsfN3rU1Bj/9k=">
<h2>Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¹Ù‡Ø¯ Ø´Ù†Ù‚ÙŠØ·</h2>

<button onclick="showForm()">â• Ø¥Ø¶Ø§ÙØ© Ø£Ø³ØªØ§Ø°</button>
<button onclick="showList()">ğŸ“‹ Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø§ØªØ°Ø©</button>
</div>

<!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ -->
<div id="form" class="card hidden">
<input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø£Ø³ØªØ§Ø°">
<input id="birthDate" placeholder="ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯">
<input id="birthPlace" placeholder="Ù…Ø­Ù„ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯">
<input id="nationalId" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ">
<input id="joinDate" placeholder="ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù„ØªØ­Ø§Ù‚">
<input id="branch" placeholder="Ø§Ù„ÙØ±Ø¹">
<input id="skill" placeholder="Ø§Ù„ÙƒÙØ§Ø¡Ø©">
<textarea id="note" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø©"></textarea>
<input type="file" id="image">
<button onclick="save()">ğŸ’¾ Ø­ÙØ¸</button>
</div>

<!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© -->
<div id="listBox" class="card hidden">
<input placeholder="ğŸ” Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø±Ù‚Ù…" onkeyup="search(this.value)">
<button onclick="exportAll()">ğŸ“„ ØªØµØ¯ÙŠØ± PDF Ù„Ù„Ø¬Ù…ÙŠØ¹</button>

<table>
<thead>
<tr>
<th>#</th>
<th>Ø§Ù„ØµÙˆØ±Ø©</th>
<th>Ø§Ù„Ø§Ø³Ù…</th>
<th>Ø§Ù„Ø±Ù‚Ù…</th>
<th>Ø¥Ø¬Ø±Ø§Ø¡</th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>
</div>

<script>
let teachers=JSON.parse(localStorage.getItem("teachers")||"[]");
let editIndex=null;

function showForm(){
form.classList.remove("hidden");
listBox.classList.add("hidden");
}

function showList(){
render(teachers);
listBox.classList.remove("hidden");
form.classList.add("hidden");
}

function save(){
const r=new FileReader();
r.onload=()=>{
const t={
name:name.value,
birthDate:birthDate.value,
birthPlace:birthPlace.value,
nationalId:nationalId.value,
joinDate:joinDate.value,
branch:branch.value,
skill:skill.value,
note:note.value,
image:r.result
};
if(editIndex!=null){teachers[editIndex]=t;editIndex=null;}
else teachers.push(t);
localStorage.setItem("teachers",JSON.stringify(teachers));
clear();
showList();
};
if(image.files[0]) r.readAsDataURL(image.files[0]);
else r.onload();
}

function render(arr){
list.innerHTML="";
arr.forEach((t,i)=>{
list.innerHTML+=`
<tr>
<td>${i+1}</td>
<td><img class="photo" src="${t.image||''}"></td>
<td>${t.name}</td>
<td>${t.nationalId}</td>
<td>
<button class="gray" onclick="edit(${i})">âœï¸</button>
<button class="red" onclick="del(${i})">ğŸ—‘ï¸</button>
<button onclick="singlePdf(${i})">ğŸ“„</button>
</td>
</tr>`;
});
}

function edit(i){
const t=teachers[i];
Object.assign(window,{
name:{value:t.name},
birthDate:{value:t.birthDate},
birthPlace:{value:t.birthPlace},
nationalId:{value:t.nationalId},
joinDate:{value:t.joinDate},
branch:{value:t.branch},
skill:{value:t.skill},
note:{value:t.note}
});
editIndex=i;
showForm();
}

function del(i){
if(confirm("Ø­Ø°ÙØŸ")){
teachers.splice(i,1);
localStorage.setItem("teachers",JSON.stringify(teachers));
render(teachers);
}
}

function search(v){
render(teachers.filter(t=>t.name.includes(v)||t.nationalId.includes(v)));
}

function exportAll(){
const {jsPDF}=window.jspdf;
const pdf=new jsPDF();
pdf.text("Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø§ØªØ°Ø© - Ù…Ø¹Ù‡Ø¯ Ø´Ù†Ù‚ÙŠØ·",10,10);
let y=20;
teachers.forEach((t,i)=>{
pdf.text(`${i+1}- ${t.name} | ${t.nationalId}`,10,y);
y+=8;
});
pdf.save("teachers.pdf");
}

function singlePdf(i){
const {jsPDF}=window.jspdf;
const t=teachers[i];
const pdf=new jsPDF();
pdf.text("ØªÙ‚Ø±ÙŠØ± Ø£Ø³ØªØ§Ø° - Ù…Ø¹Ù‡Ø¯ Ø´Ù†Ù‚ÙŠØ·",10,10);
if(t.image) pdf.addImage(t.image,"JPEG",150,20,40,40);
pdf.text("Ø§Ù„Ø§Ø³Ù…: "+t.name,10,30);
pdf.text("Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ: "+t.nationalId,10,40);
pdf.text("Ø§Ù„ÙØ±Ø¹: "+t.branch,10,50);
pdf.text("Ø§Ù„ÙƒÙØ§Ø¡Ø©: "+t.skill,10,60);
pdf.text("Ù…Ù„Ø§Ø­Ø¸Ø©: "+t.note,10,70);
pdf.save(t.name+".pdf");
}

function clear(){
document.querySelectorAll("input,textarea").forEach(e=>e.value="");
}
</script>

</body>
</html>
