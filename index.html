<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¹Ù‡Ø¯ Ø´Ù†Ù‚ÙŠØ·</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:Tahoma,Arial;background:#f4f6f8;margin:0}
header{background:#2196f3;color:#fff;text-align:center;padding:10px}
header img{width:60px;border-radius:50%}
.container{padding:10px}
button{background:#2196f3;color:#fff;border:none;padding:6px 10px;border-radius:5px;margin:2px}
input{width:100%;padding:6px;margin-bottom:6px}
.card{background:#fff;padding:8px;margin-bottom:6px;border-radius:6px;
display:flex;justify-content:space-between;align-items:center}
.hidden{display:none}
.counter{margin:8px 0;font-weight:bold}
.photo{width:120px;border-radius:6px;margin-top:6px}

#viewer{
position:fixed;top:0;left:0;right:0;bottom:0;
background:rgba(0,0,0,.6);
display:none;align-items:center;justify-content:center
}
#viewer .box{
background:#fff;padding:15px;border-radius:8px;max-width:90%
}
</style>
</head>

<body>

<header>
  <img src="logo.png">
  <div>Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¹Ù‡Ø¯ Ø´Ù†Ù‚ÙŠØ·</div>
</header>

<div class="container">

<button id="btnAdd">â• Ø¥Ø¶Ø§ÙØ© Ø£Ø³ØªØ§Ø°</button>
<button id="btnList">ğŸ“‹ Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø§ØªØ°Ø©</button>

<input id="search" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ">

<div class="counter" id="count"></div>

<!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ -->
<div id="form" class="hidden">
  <input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø£Ø³ØªØ§Ø°">
  <input id="birth" placeholder="ØªØ§Ø±ÙŠØ® ÙˆÙ…Ø­Ù„ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯">
  <input id="nid" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ">
  <input id="join" placeholder="ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù„ØªØ­Ø§Ù‚">
  <input id="branch" placeholder="Ø§Ù„ÙØ±Ø¹">
  <input id="skill" placeholder="Ø§Ù„ÙƒÙØ§Ø¡Ø©">
  <input type="file" id="photo">
  <button type="button" id="btnSave">ğŸ’¾ Ø­ÙØ¸</button>
  <button type="button" id="btnCancel">âŒ Ø¥Ù„ØºØ§Ø¡</button>
</div>

<!-- Ø§Ù„Ù„Ø§Ø¦Ø­Ø© -->
<div id="list" class="hidden"></div>
</div>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¹Ø±Ø¶ -->
<div id="viewer">
  <div class="box" id="viewerBox"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
const form = document.getElementById("form");
const list = document.getElementById("list");
const count = document.getElementById("count");
const search = document.getElementById("search");

const nameI = document.getElementById("name");
const birthI = document.getElementById("birth");
const nidI = document.getElementById("nid");
const joinI = document.getElementById("join");
const branchI = document.getElementById("branch");
const skillI = document.getElementById("skill");
const photoI = document.getElementById("photo");

const viewer = document.getElementById("viewer");
const viewerBox = document.getElementById("viewerBox");

let editIndex = null;

/* ØªØ®Ø²ÙŠÙ† */
function getData(){
  return JSON.parse(localStorage.getItem("teachers") || "[]");
}
function saveData(d){
  localStorage.setItem("teachers", JSON.stringify(d));
}

/* Ø£Ø²Ø±Ø§Ø± Ø±Ø¦ÙŠØ³ÙŠØ© */
btnAdd.onclick = ()=>{
  form.classList.remove("hidden");
  list.classList.add("hidden");
  editIndex = null;
};

btnList.onclick = ()=>{
  form.classList.add("hidden");
  list.classList.remove("hidden");
  render();
};

btnCancel.onclick = ()=>{
  clearForm();
  form.classList.add("hidden");
};

/* Ø­ÙØ¸ + ØªØ¹Ø¯ÙŠÙ„ */
btnSave.onclick = ()=>{
  let data = getData();
  let oldPhoto = editIndex!==null ? data[editIndex].photo : "";

  let teacher = {
    name: nameI.value.trim(),
    birth: birthI.value.trim(),
    nid: nidI.value.trim(),
    join: joinI.value.trim(),
    branch: branchI.value.trim(),
    skill: skillI.value.trim(),
    photo: oldPhoto
  };

  if(photoI.files[0]){
    let r = new FileReader();
    r.onload = ()=>{
      teacher.photo = r.result;
      finishSave(teacher);
    };
    r.readAsDataURL(photoI.files[0]);
  }else{
    finishSave(teacher);
  }
};

function finishSave(t){
  let data = getData();
  if(editIndex===null) data.push(t);
  else data[editIndex]=t;

  saveData(data);
  clearForm();
  form.classList.add("hidden");
  list.classList.remove("hidden");
  render();
}

/* ØªÙØ±ÙŠØº */
function clearForm(){
  nameI.value=birthI.value=nidI.value=joinI.value=branchI.value=skillI.value="";
  photoI.value="";
}

/* Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø§Ø¦Ø­Ø© + Ø¨Ø­Ø« */
search.oninput = render;

function render(){
  let q = search.value || "";
  let data = getData().filter(t=>t.name.includes(q)||t.nid.includes(q));
  list.innerHTML="";
  count.innerText="Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø§ØªØ°Ø©: "+data.length;

  data.forEach((t,i)=>{
    list.innerHTML+=`
    <div class="card">
      <div>${i+1} - ${t.name}</div>
      <div>
        <button onclick="view(${i})">Ø¹Ø±Ø¶</button>
        <button onclick="edit(${i})">âœï¸</button>
        <button onclick="del(${i})">ğŸ—‘</button>
      </div>
    </div>`;
  });
}

/* Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø£Ø³ØªØ§Ø° */
function view(i){
  let t = getData()[i];
  viewerBox.innerHTML=`
    <h3>${t.name}</h3>
    <p>Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: ${t.birth}</p>
    <p>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ: ${t.nid}</p>
    <p>Ø§Ù„Ø§Ù„ØªØ­Ø§Ù‚: ${t.join}</p>
    <p>Ø§Ù„ÙØ±Ø¹: ${t.branch}</p>
    <p>Ø§Ù„ÙƒÙØ§Ø¡Ø©: ${t.skill}</p>
    ${t.photo?`<img class="photo" src="${t.photo}">`:""}
    <br><br>
    <button onclick="exportPDF()">ğŸ“„ PDF</button>
    <button onclick="viewer.style.display='none'">Ø¥ØºÙ„Ø§Ù‚</button>
  `;
  viewer.style.display="flex";
}

/* PDF Ø¹Ø±Ø¨ÙŠ + ØµÙˆØ±Ø© */
function exportPDF(){
  html2canvas(viewerBox,{scale:2}).then(canvas=>{
    let pdf = new jspdf.jsPDF("p","mm","a4");
    let w = 190;
    let h = canvas.height * w / canvas.width;
    pdf.addImage(canvas.toDataURL("image/png"),"PNG",10,10,w,h);
    pdf.save("Ø§Ø³ØªØ§Ø°.pdf");
  });
}

/* ØªØ¹Ø¯ÙŠÙ„ */
function edit(i){
  let t = getData()[i];
  nameI.value=t.name;
  birthI.value=t.birth;
  nidI.value=t.nid;
  joinI.value=t.join;
  branchI.value=t.branch;
  skillI.value=t.skill;
  editIndex=i;
  form.classList.remove("hidden");
  list.classList.add("hidden");
}

/* Ø­Ø°Ù */
function del(i){
  let d=getData();
  d.splice(i,1);
  saveData(d);
  render();
}
</script>

</body>
</html>
